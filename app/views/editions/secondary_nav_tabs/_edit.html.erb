<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <%= render "govuk_publishing_components/components/heading", {
      text: "Edit",
      heading_level: 2,
      margin_bottom: 5,
    } %>
  </div>
</div>

<%= form_for @resource, as: :edition, url: edition_path(@resource) do |f| %>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <% if @resource.published? %>
        <%= render partial: "editions/secondary_nav_tabs/edit/published/common_fields", locals: { edition: @resource } %>

        <%= render partial: "editions/secondary_nav_tabs/edit/published/body", locals: { edition: @resource } %>

        <%= render partial: "editions/secondary_nav_tabs/edit/published/public_change_note", locals: { edition: @resource } %>
      <% else %>
        <%= render partial: "editions/secondary_nav_tabs/edit/draft/common_fields", locals: { edition: @resource } %>

        <%= render partial: "editions/secondary_nav_tabs/edit/draft/body", locals: { edition: @resource } %>

        <% if @resource.published_edition %>
          <div class="edit_edition__change_note">
            <%= render partial: "editions/secondary_nav_tabs/edit/draft/public_change_note", locals: { edition: @resource } %>
          </div>
        <% end %>
      <% end %>
    </div>

    <div class="govuk-grid-column-one-third options-sidebar">
      <% if @resource.locked_for_edits? %>
        <p class="govuk-body"><%= @resource.error_description %> can't be changed.</p>
      <% else %>
        <div class="sidebar-components">
          <%= render "govuk_publishing_components/components/heading", {
            text: "Options",
            heading_level: 3,
            font_size: "s",
            padding: true,
          } %>

          <%= render "govuk_publishing_components/components/list", {
            items: [
              (render "govuk_publishing_components/components/button", {
                text: "Save",
                margin_bottom: 3,
              } if current_user.has_editor_permissions?(@resource) && !@resource.retired_format?),
            link_to("Preview (opens in new tab)", preview_edition_path(@resource), target: "_blank", rel: "noopener", class: "govuk-link"),
            ],
          } %>
        </div>
      <% end %>
    </div>
  </div>
<% end %>
