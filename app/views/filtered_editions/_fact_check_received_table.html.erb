<%# locals: (editions:) -%>

<% tab_heading = sanitize("Returned <span class='item-count'>#{pluralize(number_with_delimiter(editions.count), 'item' )}</span>") %>

<% if editions.any? %>
  <%= render "govuk_publishing_components/components/table", {
    caption: tab_heading,
    caption_classes: "govuk-table__caption--m",
    first_cell_is_header: true,
    head: [
      { text: "Title" },
      { text: "Response" },
      { text: "Received" },
      { text: "Assigned to" },
      { text: "Content type" },
    ],
    rows: editions.map do | edition |
      [
        { text: link_to(edition.title, edit_edition_path(edition), class: "govuk-link govuk-link--no-visited-state") },
        { text:
          link_to(
            "View response",
            history_edition_path(edition,
            anchor: "edition-#{edition.history.first.version_number}"),
            class: "govuk-link govuk-link--no-visited-state",
            data: {
              'ga4-ecommerce-content-id': edition.id,
              'ga4-ecommerce-path': edition_url(edition),
            }
          )
        },
        { text: "#{time_ago_in_words(edition.most_recent_action { it.request_type == "receive_fact_check" }.created_at).capitalize} ago" },
        { text: edition.assigned_to || "None" },
        { text: edition.format.underscore.humanize },
      ]
    end,
  } %>
<% else %>
  <%= render "govuk_publishing_components/components/heading", { text: tab_heading } %>
<% end %>
